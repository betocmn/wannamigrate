{% extends "_layouts/main.html" %}
{% load staticfiles %}
{% load i18n %}
{% load string_extras %}

{% block content %}

    <div class="content hire">

        {% if 'situation' in request.session and 'from_country' in request.session.situation %}

            <section class="professionals">
                <div class="top">
                    <h2 class="title">Hire a Professional</h2>
                </div>

                {% for provider in providers.all %}

                    {% url 'marketplace:profile' provider.user_id provider.display_name|slugify as view_professional_url %}

                    <div class="professional category">
                        <div class="identity">
                            <div class="thumb">
                                <a class="link-hiring" href="{{ view_professional_url }}">
                                    {% if provider.user.userpersonal.avatar %}
                                        <img src="{{ provider.user.userpersonal.avatar.size100x100.url }}" alt="{{ provider.display_name }}" />
                                    {% else %}
                                        <img src="{% static 'site/img/thumb-professional.jpg' %}" alt="{{ provider.display_name }}" />
                                    {% endif %}
                                </a>
                            </div>
                            <div class="data-professional">
                                <strong class="name"><a class="link-hiring" href="{{ view_professional_url }}">{{ provider.display_name }}</a></strong>
                                <p class="expert"><a class="link-hiring" href="{{ view_professional_url }}">{{ provider.headline }}</a></p>
                                <div class="rate" data-score="{{ provider.review_score }}">
                                    <span class="count">({{ provider.user.userstats.total_reviews|kmi }})</span>
                                </div>
                            </div>
                            <div class="data">
                                <ul class="data-list">
                                    <li class="data-item"><a href="{{ view_professional_url }}#answers" class="data-link answers"><strong>{{ provider.user.userstats.total_answers }}</strong> answers</a></li>
                                    <li class="data-item"><a href="{{ view_professional_url }}" class="data-link viewers"><strong>{{ provider.user.userstats.total_profile_views }}</strong> viewers</a></li>
                                    <li class="data-item">{% trans "Joined" %} <strong>{{ provider.user.created_date|date:"M Y"|lower }}</strong></li>
                                </ul>
                            </div>
                        </div>
                        <p class="description"><a class="link-hiring" href="{{ view_professional_url }}">{{ provider.description|truncatechars:280 }}</a></p>
                        <a href="{{ view_professional_url }}" class="bt-hire button">Hire</a>
                        <div class="tags">
                            <ul class="tags-list">
                                {% for service_type in provider.service_types.all %}
                                    {% ifchanged %}<li class="tag"><a href="{{ view_professional_url }}#services" class="tag-link">{{ service_type.service_type_category.name }}</a></li>{% endifchanged %}
                                {% endfor %}
                            </ul>
                        </div>
                        <a href="#" class="bt-options">Options</a>
                        <div class="box-options">
                            <ul class="box">
                                <li><a class="bt-share" href="{{ view_professional_url }}">{% trans "View" %}</a></li>
                                <li><a class="bt-report" href="#">{% trans "Share" %}</a></li>
                                <li><a class="bt-cancel" href="#">{% trans "Report" %}</a></li>
                            </ul>
                        </div>
                    </div>

                {% endfor %}

            </section>
            <a href="#" class="bt-view-more button-transparent">View More</a>

        {% endif %}
    </div>

{% endblock content %}


{% block scripts %}

    {{ block.super }}

    <!-- JS REQUIRED BY THIS PAGE -->
    <script type="text/javascript" src="{% static 'common/trunk8/js/trunk8.js' %}"></script>

    <!-- INLINE JS -->
    <script type="text/javascript">

        $( document ).ready( function() {

            // Create review stars of professional
            $( '.rate' ).raty({
                starOff : '{% static 'site/img/star-off.png' %}',
                starOn  : '{% static 'site/img/star-on.png' %}',
                readOnly: true,
                score: function() {
                    return $( this ).attr( 'data-score' );
                }
            });

            // create read more or less on long texts
            $( '.truncate-line' ).trunk8({
                fill: '&hellip; <a class="more-services read-more" href="#">{% trans "see more" %}</a>'
            });
            $( '.read-more' ).on( 'click', function() {
              $( this ).parent().trunk8('revert');
              return false;
            });


        });

    </script>

    {% include "_layouts/analytics.html" %}

{% endblock scripts %}